how = c(last, mean)
) +
scale_fill_gradient(low = "black", high = color) +
labs(x = "Habitat symmetry", y = "Divergent selection")
}) %>%
plot_grid(plotlist = ., ncol = 3, labels = c("A", "B", "C"))
data <- readRDS("data/simulations.rds")
list(
c("EI", "RI", "SI"), # variables
c("lightgreen", "lightblue", "coral") # colors
) %>%
pmap(function(variable, color) {
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
ggheatmap(
variable, x = "hsymmetry", y = "ecosel", reduce = "simulation",
how = c(last, mean)
) +
scale_fill_gradient(low = "black", high = color) +
labs(x = "Habitat symmetry", y = "Divergent selection")
}) %>%
plot_grid(plotlist = ., ncol = 3, labels = c("A", "B", "C"))
data <- readRDS("data/simulations.rds")
list(
c("EI", "RI", "SI"), # variables
c("lightgreen", "lightblue", "coral") # colors
) %>%
pmap(function(variable, color) {
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
ggheatmap(
variable, x = "hsymmetry", y = "ecosel", reduce = "simulation",
how = c(last, mean)
) +
scale_fill_gradient(low = "black", high = color) +
labs(x = "Habitat symmetry", y = "Divergent selection")
}) %>%
plot_grid(plotlist = ., ncol = 3, labels = c("A", "B", "C"))
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
gglineplot(x = "time", y = "RI", line = "simulation")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
gglineplot(x = "time", y = "RI", line = "simulation") %>%
facettize(facet_rows = "hsymmetry", faccet_cols = "ecosel")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
gglineplot(x = "time", y = "RI", line = "simulation") %>%
facettize(facet_rows = "hsymmetry", facet_cols = "ecosel")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
gglineplot(x = "time", y = "RI", line = "simulation") %>%
facettize(facet_rows = "ecosel", facet_cols = "hsymmetry")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
gglineplot(x = "time", y = "RI", line = "simulation") %>%
facettize(facet_rows = "ecosel", facet_cols = "hsymmetry") +
aes(color = last(RI))
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(all_of(RI))) %>%
gglineplot(x = "time", y = "RI", line = "simulation") %>%
facettize(facet_rows = "ecosel", facet_cols = "hsymmetry") +
aes(color = last)
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") %>%
facettize(facet_rows = "ecosel", facet_cols = "hsymmetry") +
aes(color = last)
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") %>%
facettize(facet_rows = "ecosel", facet_cols = "hsymmetry") +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(ecosel = fct_rev(ecosel))
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(ecosel = fct_rev(ecosel)) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") %>%
facet_by(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(ecosel = ecosel %>% factor %>% fct_rev) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") %>%
facet_by(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(ecosel = ecosel %>% factor %>% fct_rev) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") %>%
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(ecosel = ecosel %>% factor %>% fct_rev) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(ecosel = ecosel %>% factor %>% fct_rev) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry, labeller = ~ label_both(., sep = " = ")) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(ecosel = ecosel %>% factor %>% fct_rev) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry, labeller = label_both) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(ecosel = ecosel %>% factor %>% fct_rev %>% str_replace("^", "s = ")) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry, labeller = label_both) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% fct_rev %>% str_replace("^", "s = "),
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = ")
) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% fct_rev %>% str_replace("^", "s = "),
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = ")
) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% fct_rev %>% str_replace("^", "s = "),
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = ")
) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = "),
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = ")
) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = ")
) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Time (thousands of generations)", y = "Reproductive isolation")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Time (thousands of generations)", y = "Reproductive isolation")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel, simulation) %>%
mutate(last = last(RI)) %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Time (thousands of generations)", y = "Reproductive isolation")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel, simulation) %>%
mutate(last = last(RI)) %>%
ungroup() %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Time (thousands of generations)", y = "Reproductive isolation")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel, simulation) %>%
mutate(last = last(RI)) %>%
ungroup() %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Time (thousands of generations)", y = "Reproductive isolation", fill = "RI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel, simulation) %>%
mutate(last = last(RI)) %>%
ungroup() %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Time (thousands of generations)", y = "Reproductive isolation", fill = "RI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel, simulation) %>%
mutate(last = last(RI)) %>%
ungroup() %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Time (thousands of generations)", y = "Reproductive isolation", fill = "RI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel, simulation) %>%
mutate(last = last(RI)) %>%
ungroup() %>%
gglineplot(x = "time", y = "RI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Time (thousands of generations)", y = "Reproductive isolation", color = "RI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel, simulation) %>%
mutate(last = last(EI)) %>%
ungroup() %>%
gglineplot(x = "time", y = "EI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightgreen") +
labs(x = "Time (thousands of generations)", y = "Ecological divergence", color = "EI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel, simulation) %>%
mutate(last = last(EI)) %>%
ungroup() %>%
gglineplot(x = "time", y = "EI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightgreen") +
labs(x = "Time (thousands of generations)", y = "Ecological divergence", color = "EI")
lineplots <- list(
c("EI", "RI", "SI"),
c("lightgreen", "lightblue", "coral"),
c("Ecological divergence", "Reproductive isolation", "Spatial isolation")
) %>%
pmap(function(variable, color, label) {
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel, simulation) %>%
mutate(last = last(get(variable))) %>%
ungroup() %>%
gglineplot(x = "time", y = variable, line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = color) +
labs(x = "Time (thousands of generations)", y = label, color = variable)
})
lineplots[[2]]
lineplots[[1]]
lineplots[[3]]
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel, simulation) %>%
mutate(last = last("RI")) %>%
ungroup() %>%
gglineplot(x = "EI", y = "SI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Ecological divergence", y = "Spatial isolation", color = "RI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
group_by(hsymmetry, ecosel, simulation) %>%
mutate(last = last(RI)) %>%
ungroup() %>%
gglineplot(x = "EI", y = "SI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = last) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Ecological divergence", y = "Spatial isolation", color = "RI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
ungroup() %>%
gglineplot(x = "EI", y = "SI", line = "simulation") +
facet_grid(ecosel ~ hsymmetry) +
aes(color = RI) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Ecological divergence", y = "Spatial isolation", color = "RI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
ungroup() %>%
gglineplot(x = "EI", y = "SI", line = "simulation") +
facet_wrap(. ~ ecosel) +
aes(color = SI, alpha = RI) +
scale_color_gradient(low = "black", high = "lightblue") +
labs(x = "Ecological divergence", y = "Spatial isolation", color = "RI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
ungroup() %>%
gglineplot(x = "EI", y = "SI", line = "simulation") +
facet_wrap(. ~ ecosel) +
aes(color = SI) +
scale_color_gradient(low = "black", high = "coral") +
labs(x = "Ecological divergence", y = "Spatial isolation", color = "SI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
ungroup() %>%
gglineplot(x = "EI", y = "SI", line = "simulation") +
facet_wrap(. ~ ecosel) +
aes(color = SI, alpha = RI) +
scale_color_gradient(low = "black", high = "coral") +
labs(x = "Ecological divergence", y = "Spatial isolation", color = "SI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = ") %>% fct_rev,
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
ungroup() %>%
gglineplot(x = "EI", y = "SI", line = "simulation") +
facet_wrap(. ~ ecosel) +
aes(color = SI) +
scale_color_gradient(low = "black", high = "coral") +
labs(x = "Ecological divergence", y = "Spatial isolation", color = "SI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = "),
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
ungroup() %>%
gglineplot(x = "EI", y = "SI", line = "simulation") +
facet_wrap(. ~ ecosel) +
aes(color = SI) +
scale_color_gradient(low = "black", high = "coral") +
labs(x = "Ecological divergence", y = "Spatial isolation", color = "SI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = "),
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
ungroup() %>%
gglineplot(x = "EI", y = "SI", line = "simulation") +
facet_wrap(. ~ ecosel) +
aes(color = SI) +
scale_color_gradient(low = "black", high = "coral") +
labs(x = "Ecological divergence", y = "Spatial isolation", color = "SI")
data %>%
filter(mutation == 0.0001 & scaleI == "0 0 0") %>%
mutate(
ecosel = ecosel %>% factor %>% str_replace("^", "s = "),
hsymmetry = hsymmetry %>% factor %>% str_replace("^", "h = "),
time = time / 1000
) %>%
ungroup() %>%
gglineplot(x = "EI", y = "SI", line = "simulation") +
facet_wrap(. ~ ecosel) +
aes(color = hsymmetry) +
scale_color_gradient(low = "black", high = "coral") +
labs(x = "Ecological divergence", y = "Spatial isolation", color = "h")
