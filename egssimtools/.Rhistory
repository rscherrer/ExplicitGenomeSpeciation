labs(x = x, y = y)
}
dplot_genome_violin(root, y = "genome_Fst", x = "trait")
dplot_genome_violin(root, y = "genome_Fst")
#' Diagnostic violin plot
#'
#' Quick-plots a variable across the genome, possibly split between categories
#'
#' @param root Path to the simulation folder
#' @param y Name of the variable to plot
#' @param x Optional grouping variable
#' @param t Time point at which to show the scan. If unspecified, last time point.
#'
#' @return A ggplot
#'
#' @export
dplot_genome_violin <- function(root, y, x = NULL) {
library(ggplot2)
time <- read_data(root, "time")
X <- read_data(root, y)
nloci <- nrow(X) / nrow(time)
data <- read_data(root, c("time", y), dupl = c(nloci, 1), architecture = TRUE)
if (is.null(t)) t <- last(data$time)
if (is.null(x)) {
data$x <- rep("1", nrow(data))
x <- "x"
}
data <- data %>% filter(time == t)
ggplot(data, aes(x = factor(get(x)), y = get(y))) +
geom_violin() +
theme_bw() +
labs(x = x, y = y)
}
dplot_genome_violin(root, y = "genome_Fst")
#' Diagnostic violin plot
#'
#' Quick-plots a variable across the genome, possibly split between categories
#'
#' @param root Path to the simulation folder
#' @param y Name of the variable to plot
#' @param x Optional grouping variable
#' @param t Time point at which to show the scan. If unspecified, last time point.
#'
#' @return A ggplot
#'
#' @export
dplot_genome_violin <- function(root, y, x = NULL) {
library(ggplot2)
time <- read_data(root, "time")
X <- read_data(root, y)
nloci <- nrow(X) / nrow(time)
data <- read_data(root, c("time", y), dupl = c(nloci, 1), architecture = TRUE)
if (is.null(t)) t <- last(data$time)
if (is.null(x)) {
data$x <- rep(1, nrow(data))
x <- "x"
}
data <- data %>% filter(time == t)
ggplot(data, aes(x = factor(get(x)), y = get(y))) +
geom_violin() +
theme_bw() +
labs(x = x, y = y)
}
dplot_genome_violin(root, y = "genome_Fst")
#' Diagnostic violin plot
#'
#' Quick-plots a variable across the genome, possibly split between categories
#'
#' @param root Path to the simulation folder
#' @param y Name of the variable to plot
#' @param x Optional grouping variable
#' @param t Time point at which to show the scan. If unspecified, last time point.
#'
#' @return A ggplot
#'
#' @export
dplot_genome_violin <- function(root, y, x = NULL) {
library(ggplot2)
time <- read_data(root, "time")
X <- read_data(root, y)
nloci <- nrow(X) / nrow(time)
data <- read_data(root, c("time", y), dupl = c(nloci, 1), architecture = TRUE)
if (is.null(t)) t <- last(data$time)
if (is.null(x)) {
x.. <- "1"
x <- "x.."
}
data <- data %>% filter(time == t)
ggplot(data, aes(x = factor(get(x)), y = get(y))) +
geom_violin() +
theme_bw() +
labs(x = x, y = y)
}
dplot_genome_violin(root, y = "genome_Fst")
#' Diagnostic violin plot
#'
#' Quick-plots a variable across the genome, possibly split between categories
#'
#' @param root Path to the simulation folder
#' @param y Name of the variable to plot
#' @param x Optional grouping variable
#' @param t Time point at which to show the scan. If unspecified, last time point.
#'
#' @return A ggplot
#'
#' @export
dplot_genome_violin <- function(root, y, x = NULL) {
library(ggplot2)
time <- read_data(root, "time")
X <- read_data(root, y)
nloci <- nrow(X) / nrow(time)
data <- read_data(root, c("time", y), dupl = c(nloci, 1), architecture = TRUE)
if (is.null(t)) t <- last(data$time)
rmaxis <- FALSE
if (is.null(x)) {
x.. <- "1"
x <- "x.."
rmaxis <- TRUE
}
data <- data %>% filter(time == t)
p <- ggplot(data, aes(x = factor(get(x)), y = get(y))) +
geom_violin() +
theme_bw() +
labs(x = x, y = y)
if (rmaxis) p + theme(axis.ticks.x = element_blank())
}
dplot_genome_violin(root, y = "genome_Fst")
#' Diagnostic violin plot
#'
#' Quick-plots a variable across the genome, possibly split between categories
#'
#' @param root Path to the simulation folder
#' @param y Name of the variable to plot
#' @param x Optional grouping variable
#' @param t Time point at which to show the scan. If unspecified, last time point.
#'
#' @return A ggplot
#'
#' @export
dplot_genome_violin <- function(root, y, x = NULL) {
library(ggplot2)
time <- read_data(root, "time")
X <- read_data(root, y)
nloci <- nrow(X) / nrow(time)
data <- read_data(root, c("time", y), dupl = c(nloci, 1), architecture = TRUE)
if (is.null(t)) t <- last(data$time)
rmaxis <- FALSE
if (is.null(x)) {
x.. <- "1"
x <- "x.."
rmaxis <- TRUE
}
data <- data %>% filter(time == t)
p <- ggplot(data, aes(x = factor(get(x)), y = get(y))) +
geom_violin() +
theme_bw() +
labs(x = x, y = y)
if (rmaxis) p <- p + theme(
axis.ticks.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank()
)
return(p)
}
dplot_genome_violin(root, y = "genome_Fst")
dplot_genome_violin(root, y = "genome_Fst", x = "trait")
library(egssimtools)
dplot_population_histogram <- function(root, y, by = 1, j = 1) {
}
dplot_population_histogram(root, y = "individual_trait", by = 3, j = 3)
dplot_population_histogram <- function(root, y, by = 1, j = 1) {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by))
}
dplot_population_histogram(root, y = "individual_trait", by = 3, j = 3)
?read_data
dplot_population_histogram <- function(root, y, by = 1, j = 1) {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by), dupl = list("population_size", 1))
}
dplot_population_histogram(root, y = "individual_trait", by = 3, j = 3)
dplot_population_histogram <- function(root, y, by = 1, j = 1, t = NULL) {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by), dupl = list("population_size", 1))
data <- data[, c(1, j + 1)]
if (is.null(t)) t <- last(data$time)
data <- data %>% filter(time == t)
}
dplot_population_histogram(root, y = "individual_trait", by = 3, j = 3)
dplot_population_density <- function(root, y, by = 1, j = 1, t = NULL) {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by), dupl = list("population_size", 1))
data <- data[, c(1, j + 1)]
if (is.null(t)) t <- last(data$time)
data <- data %>% filter(time == t)
ggplot(data, aes(x = get(colnames(data)[2]))) +
geom_density()
}
dplot_population_density(root, y = "individual_trait", by = 3, j = 3)
dplot_population_density <- function(root, y, by = 1, j = 1, t = NULL) {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by), dupl = list("population_size", 1))
data <- data[, c(1, j + 1)]
if (is.null(t)) t <- last(data$time)
data <- data %>% filter(time == t)
ggplot(data, aes(x = get(colnames(data)[2]))) +
geom_density() +
theme_bw()
}
dplot_population_density(root, y = "individual_trait", by = 3, j = 3)
dplot_population_density(root, y = "individual_trait", by = 3, j = 1)
dplot_population_density <- function(root, y, by = 1, j = 1, t = NULL) {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by), dupl = list("population_size", 1))
data <- data[, c(1, j + 1)]
if (is.null(t)) t <- last(data$time)
data <- data %>% filter(time == t)
ggplot(data, aes(x = get(colnames(data)[2]))) +
geom_density() +
theme_bw() +
xlab(colnames(data)[2])
}
dplot_population_density(root, y = "individual_trait", by = 3, j = 1)
#' Diagnose density of a given variable across the population
#'
#' @param root Path to the simulation folder
#' @param y Variable to plot the density for
#' @param by How many columns to split the variable into? See `?read_data`.
#' @param j If the variable is splitted, which column to show?
#' @param t Optional time point to filter. Defaults to the last time point
#'
#' @return A ggplot
#'
#' @export
dplot_population_density <- function(root, y, by = 1, j = 1, t = NULL) {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by), dupl = list("population_size", 1))
data <- data[, c(1, j + 1)]
if (is.null(t)) t <- last(data$time)
data <- data %>% filter(time == t)
ggplot(data, aes(x = get(colnames(data)[2]))) +
geom_density() +
theme_bw() +
xlab(colnames(data)[2])
}
dplot_population_density(root, y = "individual_trait", by = 3, j = 1)
library(egssimtools)
source('~/Documents/ExplicitGenomeSpeciation/egssimtools/R/dplot_population_density.R')
dplot_population_density <- function(root, y, by = 1, j = 1, t = NULL, fill = NULL) {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by), dupl = list("population_size", 1))
data <- data[, c(1, j + 1)]
if (is.null(t)) t <- last(data$time)
data <- data %>% filter(time == t)
ggplot(data, aes(x = get(colnames(data)[2]))) +
geom_density(fill = fill, alpha = 0.5) +
theme_bw() +
xlab(colnames(data)[2])
}
dplot_population_density(root, y = "individual_trait", by = 3, j = 1)
#' Diagnose density of a given variable across the population
#'
#' @param root Path to the simulation folder
#' @param y Variable to plot the density for
#' @param by How many columns to split the variable into? See `?read_data`.
#' @param j If the variable is splitted, which column to show?
#' @param t Optional time point to filter. Defaults to the last time point
#'
#' @return A ggplot
#'
#' @export
dplot_population_density <- function(root, y, by = 1, j = 1, t = NULL, fill = "lightgrey") {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by), dupl = list("population_size", 1))
data <- data[, c(1, j + 1)]
if (is.null(t)) t <- last(data$time)
data <- data %>% filter(time == t)
ggplot(data, aes(x = get(colnames(data)[2]))) +
geom_density(fill = fill) +
theme_bw() +
xlab(colnames(data)[2])
}
dplot_population_density(root, y = "individual_trait", by = 3, j = 1)
library(egssimtools)
dplot_population_bin2d <- function(root, y, by = 1, j = 1) {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by), dupl = list("population_size", 1))
data <- data[, c(1, j + 1)]
if (is.null(t)) t <- last(data$time)
ggplot(data, aes(x = time, y = get(colnames(data)[2]))) +
geom_bin2d(bins = 50) +
theme_bw() +
xlab(colnames(data)[2])
}
dplot_population_bin2d(root, y = "individual_trait", by = 3, j = 1)
#' Diagnose density of a given variable across the population through time
#'
#' @param root Path to the simulation folder
#' @param y Variable to plot the density for
#' @param by How many columns to split the variable into? See `?read_data`.
#' @param j If the variable is splitted, which column to show?
#' @param bins Number of bins for `geom_bin2d`
#'
#' @return A ggplot
#'
#' @export
dplot_population_bin2d <- function(root, y, by = 1, j = 1, bins = 50) {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by), dupl = list("population_size", 1))
data <- data[, c(1, j + 1)]
if (is.null(t)) t <- last(data$time)
ggplot(data, aes(x = time, y = get(colnames(data)[2]))) +
geom_bin2d(bins = bins) +
theme_bw() +
xlab(colnames(data)[2])
}
dplot_population_bin2d(root, y = "individual_trait", by = 3, j = 1)
#' Diagnose density of a given variable across the population through time
#'
#' @param root Path to the simulation folder
#' @param y Variable to plot the density for
#' @param by How many columns to split the variable into? See `?read_data`.
#' @param j If the variable is splitted, which column to show?
#' @param bins Number of bins for `geom_bin2d`
#'
#' @return A ggplot
#'
#' @export
dplot_population_bin2d <- function(root, y, by = 1, j = 1, bins = 50) {
library(ggplot2)
data <- read_data(root, c("time", y), by = c(1, by), dupl = list("population_size", 1))
data <- data[, c(1, j + 1)]
if (is.null(t)) t <- last(data$time)
ggplot(data, aes(x = time, y = get(colnames(data)[2]))) +
geom_bin2d(bins = bins) +
theme_bw() +
ylab(colnames(data)[2])
}
dplot_population_bin2d(root, y = "individual_trait", by = 3, j = 1)
library(egssimtools)
dplot_simulation_line <- function(root, y, x = "time", by = 1, j = 1, color = "black") {
library(ggplot2)
data <- read_data(root, c(x, y), by = c(1, by))
data <- data[, c(1, j + 1)]
if (is.null(t)) t <- last(data$time)
ggplot(data, aes(x = get(x), y = get(colnames(data)[2]))) +
geom_path(color = color) +
theme_bw() +
labs(x = x, y = colnames(data)[2])
}
dplot_simulation_line(root, y = "EI", by = 1, j = 1)
library(egssimtools)
dplot_simulation_line(root, y = "Fst", by = 3, j = 1)
library(egssimtools)
library(roxygen2)
roxygenize()
library(egssimtools)
devtools::build_vignettes()
devtools::build_vignettes()
rm(list = ls())
library(egssimtools)
library(tidyverse)
library(ggsim)
library(patchwork)
root <- "data"
# Fetch simulations folders
fetch_dirs(roots = root, level = 1)
root <- "data/example_1"
variables <- c("time", "genome_Fst")
data <- read_data(root, variables, dupl = c(300, 1), architecture = TRUE)
# Genome scan at a certain time
t <- 19900
data <- data %>% filter(time == t)
ggplot(data, aes(x = location, y = genome_Fst)) +
geom_point() +
theme_bw()
dplot_genome_scan(root, y = "genome_Fst")
dplot_genome_heatmap(root, "genome_Fst")
dplot_genome_violin(root, y = "genome_Fst", x = "trait")
dplot_genome_ridges <- function(root, y) {
library(ggplot2)
library(ggridges)
time <- read_data(root, "time")
X <- read_data(root, y)
nloci <- nrow(X) / nrow(time)
data <- read_data(root, c("time", y), dupl = c(nloci, 1), architecture = TRUE)
data <- data %>% filter(time %in% times)
p <- ggplot(data, aes(x = get(x), y = factor(time), fill = factor(trait))) +
geom_density_ridges() +
theme_bw() +
labs(x = x, y = "Time (generations)", fill = "Trait") +
scale_fill_manual(values = c("forestgreen", "goldenrod", "lightgrey")) +
xlim(c(0, max(data$genome_Fst))) +
theme(legend.position = "none")
p <- p %>% facettize(cols = y)
}
dplot_genome_ridges(root, y = "genome_Fst", x = "trait")
dplot_genome_ridges(root, y = "genome_Fst")
dplot_genome_ridges <- function(root, y, times = NULL) {
library(ggplot2)
library(ggridges)
time <- read_data(root, "time")
X <- read_data(root, y)
nloci <- nrow(X) / nrow(time)
data <- read_data(root, c("time", y), dupl = c(nloci, 1), architecture = TRUE)
if (is.null(times)) times <- unique(data$time)
data <- data %>% filter(time %in% times)
p <- ggplot(data, aes(x = get(x), y = factor(time), fill = factor(trait))) +
geom_density_ridges() +
theme_bw() +
labs(x = x, y = "Time (generations)", fill = "Trait") +
scale_fill_manual(values = c("forestgreen", "goldenrod", "lightgrey")) +
xlim(c(0, max(data$genome_Fst))) +
theme(legend.position = "none")
p <- p %>% facettize(cols = y)
}
dplot_genome_ridges(root, y = "genome_Fst")
dplot_genome_ridges <- function(root, y, times = NULL) {
library(ggplot2)
library(ggridges)
time <- read_data(root, "time")
X <- read_data(root, y)
nloci <- nrow(X) / nrow(time)
data <- read_data(root, c("time", y), dupl = c(nloci, 1), architecture = TRUE)
if (is.null(times)) times <- unique(data$time)
data <- data %>% filter(time %in% times)
p <- ggplot(data, aes(x = get(y), y = factor(time), fill = factor(trait))) +
geom_density_ridges() +
theme_bw() +
labs(x = y, y = "Time (generations)", fill = "Trait") +
scale_fill_manual(values = c("forestgreen", "goldenrod", "lightgrey")) +
xlim(c(0, max(data[[y]]))) +
theme(legend.position = "none")
p <- p %>% facettize(cols = y)
}
dplot_genome_ridges(root, y = "genome_Fst")
dplot_genome_ridges <- function(root, y, times = NULL) {
library(ggplot2)
library(ggridges)
time <- read_data(root, "time")
X <- read_data(root, y)
nloci <- nrow(X) / nrow(time)
data <- read_data(root, c("time", y), dupl = c(nloci, 1), architecture = TRUE)
if (is.null(times)) times <- unique(data$time)
data <- data %>% filter(time %in% times)
p <- ggplot(data, aes(x = get(y), y = factor(time), fill = factor(trait))) +
geom_density_ridges() +
theme_bw() +
labs(x = y, y = "Time (generations)", fill = "Trait") +
scale_fill_manual(values = c("forestgreen", "goldenrod", "lightgrey")) +
xlim(c(0, max(data[[y]]))) +
theme(legend.position = "none")
p %>% facettize(cols = y)
}
dplot_genome_ridges(root, y = "genome_Fst")
dplot_genome_ridges <- function(root, y, times = NULL) {
library(ggplot2)
library(ggridges)
time <- read_data(root, "time")
X <- read_data(root, y)
nloci <- nrow(X) / nrow(time)
data <- read_data(root, c("time", y), dupl = c(nloci, 1), architecture = TRUE)
if (is.null(times)) times <- unique(data$time)
data <- data %>% filter(time %in% times)
p <- ggplot(data, aes(x = get(y), y = factor(time), fill = factor(trait))) +
geom_density_ridges() +
theme_bw() +
labs(x = y, y = "Time (generations)", fill = "Trait") +
scale_fill_manual(values = c("forestgreen", "goldenrod", "lightgrey")) +
xlim(c(0, max(data[[y]]))) +
theme(legend.position = "none")
p %>% facettize(cols = "trait", prepend = "Trait ")
}
dplot_genome_ridges(root, y = "genome_Fst")
#' Genome-wide distributions through time
#'
#' @param root Path to the simulation
#' @param y Variable to show
#' @param times Optional vector of time points to show
#'
#' @return A ggplot
#'
#' @export
dplot_genome_ridges <- function(root, y, times = NULL) {
library(ggplot2)
library(ggridges)
time <- read_data(root, "time")
X <- read_data(root, y)
nloci <- nrow(X) / nrow(time)
data <- read_data(root, c("time", y), dupl = c(nloci, 1), architecture = TRUE)
if (is.null(times)) times <- unique(data$time)
data <- data %>% filter(time %in% times)
p <- ggplot(data, aes(x = get(y), y = factor(time), fill = factor(trait))) +
geom_density_ridges() +
theme_bw() +
labs(x = y, y = "Time (generations)", fill = "Trait") +
scale_fill_manual(values = c("forestgreen", "goldenrod", "lightgrey")) +
xlim(c(0, max(data[[y]]))) +
theme(legend.position = "none")
p %>% facettize(cols = "trait", prepend = "Trait ")
}
times <- seq(0, 19900, 1000)
dplot_genome_ridges(root, y = "genome_Fst")
times <- seq(0, 19900, 1000)
dplot_genome_ridges(root, y = "genome_Fst", times = times)
library(egssimtools)
library(egssimtools)
library(egssimtools)
library(egssimtools)
roxygen2::roxygenize()
library(egssimtools)
devtools::build_vignettes()
