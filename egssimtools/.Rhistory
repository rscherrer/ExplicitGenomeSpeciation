ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 20)
ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 30)
ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 25)
ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 26)
ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 20)
ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 20) +
theme_bw() +
scale_fill_continuous(type = "viridis")
ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 20) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait")
ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 20) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait") +
labs(fill = "Count")
ggsave("example_speciation.png", p, height = 2, width = 4, dpi = 300)
p <- ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 20) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait") +
labs(fill = "Count")
p
ggsave("example_speciation.png", p, height = 2, width = 4, dpi = 300)
# Plot a simulation through time
data <- read_individuals(simulation, "individual_trait")
data <- lapply(data, function(data) sapply(data, "[", 1))
data <- data.frame(time = mrep(as.numeric(names(data)), sapply(data, length)), data = do.call("c", data))
p <- ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 20) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait") +
labs(fill = "Count")
p
p <- ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 10) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait") +
labs(fill = "Count")
p
p <- ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait") +
labs(fill = "Count")
p
ggsave("example_speciation.png", p, height = 2, width = 4, dpi = 300)
matepref <- read_individuals(simulation, "individual_trait")
matepref <- do.call("c", lapply(data, function(data) sapply(data, "[", 2)))
data$matepref <- matepref
# Plot a simulation through time
data <- read_individuals(simulation, "individual_trait")
data <- lapply(data, function(data) sapply(data, "[", 1))
data <- data.frame(time = mrep(as.numeric(names(data)), sapply(data, length)), data = do.call("c", data))
matepref <- read_individuals(simulation, "individual_trait")
matepref <- do.call("c", lapply(data, function(data) sapply(data, "[", 2)))
length(matepref)
nrow(data)
# Plot a simulation through time
data <- read_individuals(simulation, "individual_trait")
data <- lapply(data, function(data) sapply(data, "[", 1))
length(do.call("c", data))
matepref <- read_individuals(simulation, "individual_trait")
matepref
lapply(data, function(data) sapply(data, "[", 2)
)
matepref <- read_individuals(simulation, "individual_trait")
matepref <- read_individuals(simulation, "individual_trait")
matepref <- lapply(matepref, function(data) sapply(data, "[", 2))
data$matepref <- matepref
# Plot a simulation through time
data <- read_individuals(simulation, "individual_trait")
data <- lapply(data, function(data) sapply(data, "[", 1))
data <- data.frame(time = mrep(as.numeric(names(data)), sapply(data, length)), data = do.call("c", data))
p <- ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait") +
labs(fill = "Count")
p
ggsave("example_speciation.png", p, height = 2, width = 4, dpi = 300)
matepref <- read_individuals(simulation, "individual_trait")
matepref <- lapply(matepref, function(data) sapply(data, "[", 2))
data$matepref <- matepref
matepref <- do.call("c", lapply(matepref, function(data) sapply(data, "[", 2)))
data$matepref <- matepref
matepref <- read_individuals(simulation, "individual_trait")
matepref <- do.call("c", lapply(matepref, function(data) sapply(data, "[", 2)))
# Plot a simulation through time
data <- read_individuals(simulation, "individual_trait")
data <- lapply(data, function(data) sapply(data, "[", 1))
data <- data.frame(time = mrep(as.numeric(names(data)), sapply(data, length)), data = do.call("c", data))
p <- ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait") +
labs(fill = "Count")
p
ggsave("example_speciation.png", p, height = 2, width = 4, dpi = 300)
matepref <- read_individuals(simulation, "individual_trait")
matepref <- do.call("c", lapply(matepref, function(data) sapply(data, "[", 2)))
data$matepref <- matepref
p <- ggplot(data, aes(x = matepref, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Mate preference trait") +
ylab("Ecological trait") +
labs(fill = "Count")
p
p <- ggplot(data, aes(x = matepref, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Mate preference trait") +
ylab("Ecological trait") +
labs(fill = "Count") +
xlim(c(-3, 3))
p
p <- ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait") +
labs(fill = "Count")
p
p2 <- ggplot(data, aes(x = matepref, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Mate preference trait") +
ylab("Ecological trait") +
labs(fill = "Count") +
xlim(c(-3, 3))
p2
library(cowplot)
plot_grid(p, p22)
plot_grid(p, p2)
plot_grid(p, p2, labels  c("A", "B"))
plot_grid(p, p2, labels = c("A", "B"))
plot_grid(p + theme(legend.position = "none"), p2, labels = c("A", "B"))
plot_grid(p + theme(legend.position = "none"), p2 + ylab(NULL), labels = c("A", "B"))
p2 <- ggplot(data %>% filter(time == 2900), aes(x = matepref, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Mate preference trait") +
ylab("Ecological trait") +
labs(fill = "Count") +
xlim(c(-3, 3))
p2
plot_grid(p + theme(legend.position = "none"), p2 + ylab(NULL), labels = c("A", "B"))
ylim <- c(-3, 3)
p <- p + theme(legend.position = "none") + ylim(ylim)
p2 <- p2 + ylab(NULL) + ylim(ylim)
plot_grid(p, p2, labels = c("A", "B"))
p <- ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait") +
labs(fill = "Count")
p
p2 <- ggplot(data %>% filter(time == 2900), aes(x = matepref, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Mate preference trait") +s
p2 <- ggplot(data %>% filter(time == 2900), aes(x = matepref, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Mate preference trait") +
ylab("Ecological trait") +
labs(fill = "Count") +
xlim(c(-3, 3))
p2
p2 <- ggplot(data %>% filter(time == 2900), aes(x = matepref, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Mate preference trait") +
ylab("Ecological trait") +
labs(fill = "Count") +
xlim(c(-3, 3))
p2
ylim <- c(-3, 3)
p <- p + theme(legend.position = "none") + ylim(ylim)
p2 <- p2 + ylab(NULL) + ylim(ylim)
plot_grid(p, p2, labels = c("A", "B"))
ggsave("example_speciation.png", p, height = 2, width = 4, dpi = 300)
ggsave("../pics/example_speciation.png", p, height = 2, width = 4, dpi = 300)
p <- plot_grid(p, p2, labels = c("A", "B"))
ggsave("../pics/example_speciation.png", p, height = 2, width = 4, dpi = 300)
ggsave("../pics/example_speciation.png", p, height = 2, width = 5, dpi = 300)
ggsave("../pics/example_speciation.png", p, height = 2, width = 6, dpi = 300)
p <- ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait") +
labs(fill = "Count")
p
matepref <- read_individuals(simulation, "individual_trait")
matepref <- do.call("c", lapply(matepref, function(data) sapply(data, "[", 2)))
data$matepref <- matepref
p2 <- ggplot(data %>% filter(time == 2900), aes(x = matepref, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Mate preference trait") +
ylab("Ecological trait") +
labs(fill = "Count") +
xlim(c(-3, 3))
p2
ylim <- c(-3, 3)
p <- p + theme(legend.position = "none") + ylim(ylim)
p2 <- p2 + ylab(NULL) + ylim(ylim)
p3 <- plot_grid(p, p2, labels = c("A", "B"), rel_widths = c(2, 1))
p3
ggsave("../pics/example_speciation.png", p3, height = 2, width = 6, dpi = 300)
p3 <- plot_grid(p, p2, labels = c("A", "B"), rel_widths = c(1, 1))
p3
ggsave("../pics/example_speciation.png", p3, height = 2, width = 6, dpi = 300)
p3 <- plot_grid(p, p2, labels = c("A", "B"), rel_widths = c(1.5, 1))
p3
ggsave("../pics/example_speciation.png", p3, height = 2, width = 6, dpi = 300)
p2
plot_grid(ggplot() + geom_void(), p2)
plot_grid(ggplot() + geom_blank(), p2)
plot_grid(ggplot() + geom_blank() + theme_void(), p2)
plot_grid(ggplot() + geom_blank() + theme_void(), p2, rel_widths = c(1, 9))
p2 <- plot_grid(ggplot() + geom_blank() + theme_void(), p2, rel_widths = c(1, 9))
p3 <- plot_grid(p, p2, labels = c("A", "B"), rel_widths = c(1.5, 1))
p3
p3 <- plot_grid(p, p2, labels = c("A", "B"), rel_widths = c(1, 1))
p3
p2 <- ggplot(data %>% filter(time == 2900), aes(x = matepref, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Mate preference trait") +
ylab("Ecological trait") +
labs(fill = "Count") +
xlim(c(-3, 3))
p2
p2 <- plot_grid(ggplot() + geom_blank() + theme_void(), p2, rel_widths = c(1, 11))
p3 <- plot_grid(p, p2, labels = c("A", "B"), rel_widths = c(1, 1))
p3
ggsave("../pics/example_speciation.png", p3, height = 2, width = 6, dpi = 300)
#' Read ecotype trait means
#'
#' Means of the three traits within each ecotype for each time point
#'
#' @param filename Path to the folder
#'
#' @export
read_ecotype_means <- function(folder) {
data <- read_data(folder, "ecotype_means")
if ("time.dat" %in% list.files(folder)) {
t <- read_time(folder)
} else {
t <- seq_len(length(data) / 6)
}
t <- rep(t, each = 6) # per time point
lapply(split(data, t), split, c(1, 2, 3)) # per trait per ecotype
}
rm(list = ls())
library(egssimtools)
library(tidyverse)
library(cowplot)
simulation <- "../build/release"
read_paramfile(paste0(simulation, "/paramlog.txt"))
read_parameters(simulation)
read_binary(paste0(simulation, "/time.dat"))
read_ecotype_means(simulation)
#' Read ecotype trait means
#'
#' Means of the three traits within each ecotype for each time point
#'
#' @param filename Path to the folder
#'
#' @export
read_ecotype_means <- function(folder) {
data <- read_data(folder, "ecotype_means")
if ("time.dat" %in% list.files(folder)) {
t <- read_time(folder)
} else {
t <- seq_len(length(data) / 6)
}
t <- rep(t, each = 6) # per time point
lapply(split(data, t), split, c(1, 2, 3)) # per trait per ecotype
}
read_means(simulation)
read_ecotype_means(simulation)
roxygenize()
roxygenize()
library(egssimtools)
rm(list = ls())
library(egssimtools)
library(tidyverse)
library(cowplot)
simulation <- "../build/release"
read_paramfile(paste0(simulation, "/paramlog.txt"))
read_parameters(simulation)
read_binary(paste0(simulation, "/time.dat"))
read_ecotype_means(simulation)
read_ecotype_sizes(simulation)
rm (list = ls())
rm(list = ls())
simulation <- "../build/release"
# Plot a simulation through time
data <- read_individuals(simulation, "individual_trait")
data <- lapply(data, function(data) sapply(data, "[", 1))
data <- data.frame(time = mrep(as.numeric(names(data)), sapply(data, length)), data = do.call("c", data))
p <- ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = 15) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
ylab("Ecological trait") +
labs(fill = "Count")
p
plot_traits_heatmap <- function(folder, trait, bins = 15) {
# Plot a simulation through time
data <- read_individuals(simulation, "individual_trait")
data <- lapply(data, function(data) sapply(data, "[", trait))
data <- data.frame(time = mrep(as.numeric(names(data)), sapply(data, length)), data = do.call("c", data))
ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = bins) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
labs(fill = "Count")
}
plot_traits_heatmap <- function(folder, trait, bins = 15) {
# Plot a simulation through time
data <- read_individuals(folder, "individual_trait")
data <- lapply(data, function(data) sapply(data, "[", trait))
data <- data.frame(time = mrep(as.numeric(names(data)), sapply(data, length)), data = do.call("c", data))
ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = bins) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
labs(fill = "Count")
}
# Single plots
plot_traits_heatmap(simulation, trait = 1)
roxygenize()
# Single plots
plot_traits_heatmap(simulation, trait = 1)
# Single plots
plot_traits_heatmap(simulation, trait = 1) + ylab("Ecological trait")
# Single plots
plot_traits_heatmap(simulation, trait = 1) + ylab("Ecological trait") + theme(legend.position = "none")
# Plot a simulation through time
data <- read_individuals(folder, "individual_trait")
folder <- simulation
# Plot a simulation through time
data <- read_individuals(folder, "individual_trait")
data <- lapply(traits, function(trait) {
lapply(data, function(data) sapply(data, "[", trait))
})
traits = c(1, 2)
data <- lapply(traits, function(trait) {
lapply(data, function(data) sapply(data, "[", trait))
})
time = 1900
data <- data.frame(
time = mrep(as.numeric(names(data[[1]])), sapply(data[[1]], length)),
do.call("cbind", lapply(data, do.call("c")))
)
data <- data.frame(
time = mrep(as.numeric(names(data[[1]])), sapply(data[[1]], length)),
do.call("cbind", lapply(data, function(data) do.call("c", data)))
)
data <- data.frame(
time = mrep(as.numeric(names(data[[1]])), sapply(data[[1]], length)),
do.call("cbind", lapply(data, function(data) do.call("c", data)))
)
head(data)
ggplot(data, aes(x = X1, y = X2)) +
geom_bin2d(bins = bins) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
labs(fill = "Count")
bins = 15
ggplot(data, aes(x = X1, y = X2)) +
geom_bin2d(bins = bins) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
labs(fill = "Count")
t <- 1900
if (!is.null(time)) data <- data %>% filter(time == t)
ggplot(data, aes(x = X1, y = X2)) +
geom_bin2d(bins = bins) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
labs(fill = "Count")
roxygenize()
library(egssimtools)
plot_trait_heatmap2D(simulation)
library(egssimtools)
plot_trait_heatmap2D(simulation)
library(egssimtools)
ggplot(data, aes(x = time, y = data)) +
geom_bin2d(bins = bins) +
theme_bw() +
scale_fill_continuous(type = "viridis") +
xlab("Time (generations)") +
labs(fill = "Count")
plot_trait_heatmap2D(simulation)
plot_trait_heatmap2D(simulation, traits = c(2, 1))
plot_trait_heatmap2D(simulation, traits = c(2, 1), t = 2900)
plot_trait_heatmap2D(simulation, traits = c(2, 1), t = 2900, bins = 15)
plot_trait_heatmap2D(simulation, traits = c(2, 1), t = 2900) +
xlab("Mating preference") +
ylab("Ecological trait") +
xlim(c(-3, 3))
# Single plots
p <- plot_traits_heatmap(simulation, trait = 1) +
ylab("Ecological trait") +
theme(legend.position = "none")
p2 <- plot_trait_heatmap2D(simulation, traits = c(2, 1), t = 2900) +
xlab("Mating preference") +
ylab("Ecological trait") +
xlim(c(-3, 3))
library(egssimtools)
# Single plots
p <- plot_traits_heatmap(simulation, trait = 1) +
ylab("Ecological trait") +
theme(legend.position = "none")
p2 <- plot_trait_heatmap2D(simulation, traits = c(2, 1), t = 2900) +
xlab("Mating preference") +
ylab("Ecological trait") +
xlim(c(-3, 3))
# Single plots
p <- plot_traits_heatmap(simulation, trait = 1) +
ylab("Ecological trait")
p
p2 <- plot_trait_heatmap2D(simulation, traits = c(2, 1), t = 2900) +
xlab("Mating preference") +
ylab("Ecological trait") +
xlim(c(-3, 3))
p2
# Rearrange into a single figure
p <- p + theme(legend.position = "none") + ylim(ylim)
p2 <- p2 + ylab(NULL)
p
# Rearrange into a single figure
p <- p + theme(legend.position = "none")
p2 <- p2 + ylab(NULL)
# Rearrange into a single figure
p <- p + theme(legend.position = "none") + ylim(c(-3, 3))
p2 <- p2 + ylab(NULL) + ylim(c(-3, 3))
# Single plots
p <- plot_traits_heatmap(simulation, trait = 1) +
ylab("Ecological trait")
p
p2 <- plot_trait_heatmap2D(simulation, traits = c(2, 1), t = 2900) +
xlab("Mating preference") +
ylab("Ecological trait") +
xlim(c(-3, 3))
p2
# Rearrange into a single figure
p <- p + theme(legend.position = "none") + ylim(c(-3, 3))
p2 <- p2 + ylab(NULL) + ylim(c(-3, 3))
p2. <- plot_grid(ggplot() + geom_blank() + theme_void(), p2, rel_widths = c(1, 11))
p3 <- plot_grid(p, p2., labels = c("A", "B"), rel_widths = c(1, 1))
p3
ggsave("../pics/example_speciation.png", p3, height = 2, width = 6, dpi = 300)
roxygenize()
library(egssimtools)
.
library(egssimtools)
# Single plots
p <- plot_traits_density(simulation, trait = 1) +
ylab("Ecological trait")
# Single plots
p <- plot_trait_density(simulation, trait = 1) +
ylab("Ecological trait")
p
